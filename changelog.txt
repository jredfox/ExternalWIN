Changelog 1.0.12 (BUG MUNCHER II):
- Fixed your online OneDrive Accidently Getting Erased After Re-Applying an Image with a OneDrive Account
- Fixed OneDrive Offline Files Causing WINPE 11 to fail if it was Captured on a WinPE 10 Image
- Fixed C:\found.* cacheing OneDrive Offline Files causing dism to fail they are now excluded
- Fixed C:\Users\defaultuser0-9* causing DISM to fail with NTUSER.dat being 0 Bytes. It now Excludes this
- Fixed C:\Windows\System32\WDI copying OneDrive offline files without the Offline attribute causing DISM to fail it's now excluded if search is on and if it's not on you can exclude the bugged files in the configs
- Fixed WIM-Capture.bat & CleanupPar.bat checking for ~3,3 and ~2,2 instead of ~3,1 and 2,1 because ~3,3 is the third character with the next 3 characters not a substring. Even though it still worked for what it was needed for
- Fixed Accidental Deleting of Operating System files from forcedelete.bat when it was opened as admin by mistake with no first arguement
- Fixed Junctions, Symlinks, Shortcuts, Hard links getting messed with when capturing or applying the image
- Fixed having the S flag for del command when it was working with single file deletions and made the code more readable
- Fixed CleanupPar.bat (fixed always having c drive as true, fixed check logic method and main for loop)
- Fixed Batch for loops special characters such as $ in file paths would mess up the scripts in WinPE. We Use Type command instead of usebaq and builtin forloop
- Fixed forcedelete.bat fallowing junctions / symlink dirs which would result in unintended files being deleted. It now Removes the Junction and SYMLINKD Dirs before starting the proccess. And I checked the del command with the flags I had deleted the link itself and not the file it was linking to
- Added Dynamic Exclusion Lists Capture/Apply Configs that change based on relative path of the target drive for example \Windows\System32 and the target is \Windows\ it would change to \System32
- Added Static exclusions that start with S:\target instead of (C:\target or \target) this is implemented for both Apply and Capture Exclusions. This means it will always be the same path and always get added to the generated exclusion list
- Added Config Option OptimizedWIMCapture when true if no onedrive accounts are detected it will skip the scanning of the target drive/dir
- Added Config Option OneDriveLinkScan when true scans for offline onedrive links on the target drive/dir
- Added Config Option /EA (Extended Attributes) that when true will capture and apply Extended Attributes that's almost only used by WSL (Windows Sub Linux System)
- Added Config Option ApplyExclusions that when true allows for Applying/Extracting Exclusions
- Added \EXTWINCAP$target file that is dynamcially generated when using WIM-Capture.bat
- Added forward slash support for WinInstall.bat, WinInstallVHDX-Custom.bat, WinInstallVHDX.bat, WIM-Capture.bat, WIMApply-Universal.bat, WIMApply-W.bat in case user error when inputting files
- Added WARNINGS to Dangerous scripts such as WIM-Extract.bat and forcedelete.bat
- Added ShortCutFixer.bat Command Line Utility & User Script. This will fix previous Windows Installations installed from ExternalWIN causing Junctions, SYMLINK Dirs, SYMLINK FILES to have W:\ instead of what they are suppose to be
- Added DirSafe-x64.exe, DirSafe-x86.exe And DirSafe-ARM64.exe. This is the enhanced version of the dir comamnd and actually works with recursion properly
- Added MountVDISK.bat(also unmounts) to mount VDISKS in WinPE for use of stuff like ShortCutFixer.bat
- Improved LoadConfig.bat to automatically re-add missing config options without manual deletion
- Improved Better Directory Paths of ExternalWIN's WIM Images and VDISKS to C:\ExternalWIN\ImageBackups\<COMPUTER>\WIMS and C:\ExternalWIN\ImageBackups\<COMPUTER>\VDISKS for when there isn't a Absolute Path Specified in Regular Windows
- Improved WIM-Capture.bat Logic not saving C:\ExternalWIN\* as there is VDISKS WIM Images and Backup of reg/boots that aren't really needed in a backup of the C Drive and will save hundreds of GB of space. You can still use WIM-Capture.bat to Capture C:\ExteranlWIN by only capturing it
- Improved WIMApply-W.bat it now enforces the volume as an Integer
- Improved WIM-Extract.bat. It now supports it's own Apply Exclusion List, EA flag, config options
- Improved WIM-Merge.bat, WIM-Extract.bat and ESD2WIM.bat in how it gets the WIM Size. It also fixes the error messages when the index > wim index size
- Improved call PP more often
- Changed LoadConfig.bat now gets called in WinPE as most of the config options are now both for WinPE and Windows
